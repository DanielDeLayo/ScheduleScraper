# ScheduleScraper
Small Solar List View Schedule to .ics scrapper
http://jsfiddle.net/mvea1mmw/

Available (and best used) as a bookmarklet generated by http://bookmarklets.org/maker/
<a id="lnk" title="Drag to your bookmarks bar" href="javascript:void function(){function e(e){var n=e.split("/");return n[2]+n[0]+n[1]}function n(e){var n=e.split("/");return n[2]+n[0]+(parseInt(n[1])-10)}function t(e){return e.includes("PM")%3F(e=e.replace("PM",""),1200>e%26%26(e=parseInt(e)+1200)):(e=e.replace("AM",""),parseInt(e)<1e3%26%26(e="0"+e)),e+="00"}function r(e){for(var n=e.replace("LBR","Library").replace("WESTCAMPUS","").replace("COMPUTER SCI","Old Computer Science").replace("HLL","Hall").split(" "),t="",r=0;r<n.length;r++){t+=n[r].charAt(0).toUpperCase();for(var a=1;a<n[r].length;a++)t+=n[r].charAt(a).toLowerCase();r<n.length-1%26%26(t+=" ")}return t}for(var a=frames[0].document.getElementById("ACE_STDNT_ENRL_SSV2$0").rows,l="BEGIN:VCALENDAR\nPRODID:-//Google Inc//Google Calendar 70.9054//EN\nVERSION:2.0\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nX-WR-CALNAME:Schedule\nX-WR-TIMEZONE:America/New_York\nX-WR-CALDESC:My Schedule\n",i=1;i<a.length;i+=2)for(var s=a[i].getElementsByTagName("table")[0],m=s.rows[1].getElementsByTagName("table")[0].rows[2].getElementsByTagName("table")[0],T=1;T<m.rows.length;T++){var c=m.rows[T].getElementsByTagName("td"),E=s.rows[0].getElementsByTagName("table")[0].getElementsByTagName("table")[0].rows[0].innerHTML.trim(),o=E.substring(E.indexOf(">")+1).split(" - ")[0];c[2].getElementsByTagName("span")[0].innerHTML.trim().includes("Recitation")%26%26(o+=" REC"),c[2].getElementsByTagName("span")[0].innerHTML.trim().includes("Lab")%26%26(o+=" Lab");var g=c[6].getElementsByTagName("span")[0].innerHTML.trim(),N=e(g.split(" - ")[0].trim()),u=c[3].getElementsByTagName("span")[0].innerHTML.trim().split(" - "),d=u[0].replace(":","");d=d.substring(d.length-6).trim(),d=t(d);var A=N+"T"+d,p=u[1].replace(":","");p=t(p);for(var L=N+"T"+p,S=n(g.split(" - ")[1].trim())+"T010000",R=u[0].substring(0,u[0].length-7).trim(),C="",I=0;I<R.length-1;I+=2){var D=R.substring(I,I+2);D.includes("Th")%3FC+="TH":D.includes("Tu")%3FC+="TU":D.includes("We")%3FC+="WE":D.includes("Mo")%3FC+="MO":D.includes("Fr")%3FC+="FR":D.includes("Sa")%3FC+="SA":D.includes("Su")%3FC+="SU":alert("Unrecognized Date:"+D),I<R.length-2%26%26(C+=",")}var M=c[4].getElementsByTagName("span")[0].innerHTML.trim();M=r(M);var h=(new Date).toJSON().slice(0,10).replace(/-/g,""),y=c[5].getElementsByTagName("span")[0].innerHTML.trim();l+="BEGIN:VEVENT\nCLASS:PUBLIC\nDTSTART;TZID=America/New_York:"+A+"\nRRULE:FREQ=WEEKLY;UNTIL="+S+";BYDAY="+C+"\nDTEND;TZID=America/New_York:"+L+"\nEXDATE;TZID=America/New_York:"+A+"\nDTSTAMP:"+h+"\nLOCATION:"+M+"\nDESCRIPTION;LANGUAGE=en-us:"+y+"\nTRANSP:TRANSPARENT\nSUMMARY:"+o.trim()+"\nEND:VEVENT\n"}l+="END:VCALENDAR";var B=document.createElement("a");B.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(l)),B.setAttribute("download","schedule.ics"),B.style.display="none",document.body.appendChild(B),B.click(),document.body.removeChild(B)}();">Drag to your bookmarks bar</a>

Useful dev link: 
https://tools.ietf.org/html/rfc5545#section-3.2.13
